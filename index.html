<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>오늘의 영어 문장 (전체화면 복원)</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #222;
    }

    .app-wrapper {
      width: 100vw; height: 100vh;
      display: flex; flex-direction: column;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
    }

    /* Header */
    .header { text-align: center; color: #fff; padding: 16px 20px 8px; }
    .date { opacity: .95; font-size: 14px; font-weight: 600; margin-bottom: 6px; }
    .title { font-size: 22px; font-weight: 800; }
    .subtitle { font-size: 13px; opacity: .95; margin-top: 6px; }
    .streak { display: inline-block; margin-top: 10px; background: #fff3cd; color:#856404; padding:4px 12px; border-radius: 16px; font-size: 13px; font-weight: 700; }

    /* Progress */
    .progress-container { display:flex; align-items:center; justify-content:center; gap:14px; padding: 10px 20px 6px; }
    .progress-indicator { color:#fff; font-weight:800; }
    .progress-dots { display:flex; gap:8px; }
    .dot { width:10px; height:10px; border-radius:50%; background:#dae1f7; opacity:.9; transition:.2s; }
    .dot.active { background:#fff; transform: scale(1.25); }

    /* Slider area: full width, inner content 90% (5% margins) */
    .slider-outer { flex: 1 1 auto; display:flex; align-items:center; justify-content:center; }
    .slider-container { position: relative; width: 100vw; overflow: hidden; }
    .slider-wrapper { display:flex; transition: transform .3s ease; height: 100%; will-change: transform; }
    .slide { min-width: 100vw; padding: 0 5vw; display:flex; align-items:stretch; justify-content:center; }

    /* Card */
    .card { background:#fff; width:100%; max-width:700px; border-radius:16px; padding:22px; box-shadow: 0 14px 40px rgba(0,0,0,.25); }
    .situation-tag { display:inline-block; background:#e7f3ff; color:#0066cc; padding:5px 12px; border-radius:14px; font-size:12px; font-weight:700; margin-bottom:12px; }
    .conversation { margin-bottom: 16px; }
    .dialog-item { display:flex; align-items:flex-start; gap:10px; margin-bottom: 14px; }
    .speaker-icon { font-size:22px; flex-shrink:0; }
    .dialog-content { flex:1; }
    .speaker-label { font-size:12px; font-weight:700; color:#666; margin-bottom:4px; }
    .english { font-size:17px; font-weight:700; color:#333; line-height:1.5; margin-bottom:6px; }
    .korean { font-size:15px; color:#666; line-height:1.5; }
    .hidden { display:none !important; }

    .speaker-btn { background:#667eea; color:#fff; border:none; border-radius:50%; width:36px; height:36px; font-size:16px; cursor:pointer; flex-shrink:0; transition: transform .2s; }
    .speaker-btn:active { transform: scale(.95); }

    .toggle-btn { background:#fff; border:2px solid #667eea; color:#667eea; padding:10px 16px; border-radius:12px; cursor:pointer; font-size:14px; font-weight:700; display:block; margin: 10px auto 6px; transition:.2s; }
    .toggle-btn:hover { background:#667eea; color:#fff; }

    .analysis-section { background:#fff; border:2px solid #e9ecef; border-radius:12px; padding:14px; margin-top:12px; }
    .section-title { font-size:14px; font-weight:800; color:#667eea; margin-bottom:10px; display:flex; align-items:center; gap:6px; }
    .vocabulary-list { display:flex; flex-direction:column; gap:10px; }
    .vocab-item { background:#f8f9fa; padding:10px; border-radius:8px; border-left:3px solid #667eea; }
    .vocab-word { font-weight:800; color:#333; font-size:14px; margin-bottom:3px; }
    .vocab-meaning { color:#666; font-size:13px; line-height:1.5; }
    .structure-box { background:#fff3cd; padding:12px; border-radius:8px; border-left:3px solid #ffc107; }
    .structure-text { color:#856404; font-size:13px; line-height:1.6; margin-bottom:8px; }
    .structure-pattern { background:#fff; padding:8px; border-radius:6px; font-weight:800; color:#333; font-size:13px; }

    .swipe-hint { text-align:center; color:#f0f3ff; font-size:12px; margin: 6px 0 0; display:flex; align-items:center; justify-content:center; gap:8px; }
    .arrow { font-size:18px; animation: bounce 1.5s infinite; }
    @keyframes bounce { 0%,100%{transform:translateX(0);opacity:.6;} 50%{transform:translateX(-4px);opacity:1;} }
    .arrow.right { animation: bounceRight 1.5s infinite; }
    @keyframes bounceRight { 0%,100%{transform:translateX(0);opacity:.6;} 50%{transform:translateX(4px);opacity:1;} }

    .footer { padding: 10px 16px 16px; }
    .check-btn { background:#28a745; color:#fff; border:none; padding:14px; border-radius:12px; cursor:pointer; font-size:16px; font-weight:800; width: min(700px, 90vw); margin: 10px auto 0; display:block; }
    .check-btn.completed { background:#6c757d; cursor:not-allowed; }
    .tip { background:#e7f3ff; border-left:4px solid #667eea; padding:12px; border-radius:8px; margin: 10px auto 0; font-size:13px; color:#444; width: min(700px, 90vw); }
    .tip-title { font-weight:800; color:#667eea; margin-bottom:6px; }

    @media (max-width: 768px){ .english{font-size:16px;} .speaker-btn{width:32px;height:32px;} .card{padding:18px;} }
  </style>
</head>
<body>
  <div class="app-wrapper">
    <!-- Header -->
    <div class="header">
      <div class="date" id="todayDate"></div>
      <div class="title">💬 오늘의 영어 대화</div>
      <div class="subtitle">학부모-자녀 일상 표현</div>
      <div class="streak" id="streakBadge">🔥 연속 0일</div>
    </div>

    <!-- Progress -->
    <div class="progress-container">
      <div class="progress-indicator" id="progressText">1/3</div>
      <div class="progress-dots">
        <div class="dot active" data-index="0"></div>
        <div class="dot" data-index="1"></div>
        <div class="dot" data-index="2"></div>
      </div>
    </div>

    <!-- Slider (full width; inner 90%) -->
    <div class="slider-outer">
      <div class="slider-container" id="sliderContainer">
        <div class="slider-wrapper" id="sliderWrapper"></div>
      </div>
    </div>

    <div class="swipe-hint"><span class="arrow">←</span> 좌우로 스와이프하여 이동 <span class="arrow right">→</span></div>

    <!-- Footer: actions -->
    <div class="footer">
      <button class="check-btn" id="checkBtn" onclick="completeToday()">오늘 학습 완료! ✅</button>
      <div class="tip">
        <div class="tip-title">💡 학습 TIP</div>
        <div>자녀와 함께 소리 내어 읽어보세요. 실제 상황에서 자연스럽게 사용할 수 있는 표현들입니다!</div>
      </div>
    </div>
  </div>

  <script>
    // ===== 콘텐츠 데이터 =====
    const dailyConversations = [
      {
        situation: "아침에 깨우기",
        dialogs: [
          { speaker: "엄마", icon: "👩", english: "Time to wake up, sweetie!", korean: "일어날 시간이야, 얘야!" },
          { speaker: "아이", icon: "😴", english: "Five more minutes, please.", korean: "5분만 더요, 제발요." }
        ],
        vocabulary: [
          { word: "wake up", meaning: "일어나다 (동사구)" },
          { word: "sweetie", meaning: "얘야, 자기야 (애칭)" }
        ],
        structure: "Time to + 동사원형: '~할 시간이야'라는 관용표현입니다.",
        pattern: "Time to + 동사원형"
      },
      {
        situation: "아침 식사 준비",
        dialogs: [
          { speaker: "아빠", icon: "👨", english: "What would you like for breakfast?", korean: "아침으로 뭐 먹고 싶어?" },
          { speaker: "아이", icon: "🧒", english: "Can I have cereal with milk?", korean: "우유랑 시리얼 먹어도 돼요?" }
        ],
        vocabulary: [
          { word: "would like", meaning: "~하고 싶다 (want보다 정중한 표현)" },
          { word: "cereal", meaning: "시리얼 (명사)" }
        ],
        structure: "What would you like for ~?는 '~로 무엇을 원하니?'라는 정중한 질문입니다.",
        pattern: "What would you like for + 명사?"
      },
      {
        situation: "등교 준비",
        dialogs: [
          { speaker: "엄마", icon: "👩", english: "Don't forget your homework.", korean: "숙제 잊지 마." },
          { speaker: "아이", icon: "🎒", english: "It's already in my backpack.", korean: "이미 가방에 넣었어요." }
        ],
        vocabulary: [
          { word: "forget", meaning: "잊다 (동사)" },
          { word: "backpack", meaning: "책가방 (명사)" }
        ],
        structure: "Don't forget는 '잊지 마'라는 명령문입니다.",
        pattern: "Don't forget + 명사"
      },
// ===== Day 4: 저녁 식사 =====
{ situation:"저녁 준비", dialogs:[{speaker:"엄마",icon:"👩",english:"Dinner will be ready in 10 minutes.",korean:"저녁이 10분 후에 준비될 거야."},{speaker:"아이",icon:"🍽️",english:"What are we having tonight?",korean:"오늘 저녁은 뭐예요?"}], vocabulary:[{word:"will be ready",meaning:"준비될 것이다 (미래)"},{word:"in + 시간",meaning:"~후에 (전치사)"}], structure:"will be ready in ~은 미래 표현입니다.", pattern:"주어 + will be + 형용사 + in + 시간" },
{ situation:"식사 시작", dialogs:[{speaker:"아빠",icon:"👨",english:"Let's eat! It looks delicious.",korean:"먹자! 맛있어 보인다."},{speaker:"아이",icon:"😋",english:"I'm so hungry!",korean:"너무 배고파요!"}], vocabulary:[{word:"Let's",meaning:"~하자 (제안)"},{word:"hungry",meaning:"배고픈 (형용사)"}], structure:"Let's + 동사원형은 제안 표현입니다.", pattern:"Let's + 동사원형" },
{ situation:"식사 중 대화", dialogs:[{speaker:"엄마",icon:"👩",english:"How does it taste?",korean:"맛이 어때?"},{speaker:"아이",icon:"👍",english:"It's really good! Can I have more?",korean:"정말 맛있어요! 더 먹어도 돼요?"}], vocabulary:[{word:"taste",meaning:"맛이 나다 (동사)"},{word:"really",meaning:"정말 (부사)"}], structure:"How does it ~?는 상태 질문입니다.", pattern:"How does it + 동사?" },

// ===== Day 5: 숙제와 공부 =====
{ situation:"숙제 시작", dialogs:[{speaker:"아빠",icon:"👨",english:"Did you finish your homework?",korean:"숙제 다 했어?"},{speaker:"아이",icon:"📚",english:"Not yet. I'm working on it now.",korean:"아직이요. 지금 하고 있어요."}], vocabulary:[{word:"finish",meaning:"끝내다 (동사)"},{word:"work on",meaning:"~을 하다 (동사구)"}], structure:"Did you ~?는 과거 행동을 묻는 의문문입니다.", pattern:"Did you + 동사원형?" },
{ situation:"숙제 도움", dialogs:[{speaker:"아이",icon:"🤔",english:"This problem is too hard.",korean:"이 문제 너무 어려워요."},{speaker:"엄마",icon:"👩",english:"Let me help you with that.",korean:"내가 도와줄게."}], vocabulary:[{word:"too",meaning:"너무 (부사)"},{word:"Let me",meaning:"내가 ~할게 (제안)"}], structure:"too + 형용사는 '너무 ~해서'의 의미입니다.", pattern:"too + 형용사" },
{ situation:"공부 격려", dialogs:[{speaker:"아빠",icon:"👨",english:"You're doing a great job!",korean:"정말 잘하고 있어!"},{speaker:"아이",icon:"😊",english:"Thank you for helping me!",korean:"도와주셔서 감사해요!"}], vocabulary:[{word:"do a great job",meaning:"훌륭하게 하다 (표현)"},{word:"Thank you for ~ing",meaning:"~해주셔서 감사합니다"}], structure:"Thank you for + 동명사는 감사 표현입니다.", pattern:"Thank you for + ~ing" },

// ===== Day 6: TV와 여가 =====
{ situation:"TV 시청 요청", dialogs:[{speaker:"아이",icon:"📺",english:"Can I watch TV for a little while?",korean:"TV 조금만 봐도 돼요?"},{speaker:"아빠",icon:"👨",english:"Finish your homework first.",korean:"숙제부터 끝내."}], vocabulary:[{word:"for a little while",meaning:"잠깐 동안 (시간 표현)"},{word:"first",meaning:"먼저, 우선 (부사)"}], structure:"명령문 + first는 순서 지시입니다.", pattern:"동사원형 + first" },
{ situation:"TV 시간 제한", dialogs:[{speaker:"엄마",icon:"👩",english:"You can watch for 30 minutes.",korean:"30분만 봐도 돼."},{speaker:"아이",icon:"😊",english:"Okay! Thank you, Mom!",korean:"알겠어요! 고마워요, 엄마!"}], vocabulary:[{word:"can",meaning:"~할 수 있다 (조동사)"},{word:"for + 시간",meaning:"~동안 (전치사)"}], structure:"You can + 동사는 허락을 나타냅니다.", pattern:"You can + 동사원형" },
{ situation:"게임 시간", dialogs:[{speaker:"아이",icon:"🎮",english:"Can I play video games?",korean:"비디오 게임 해도 돼요?"},{speaker:"아빠",icon:"👨",english:"Only after you clean your room.",korean:"방 청소한 후에만 돼."}], vocabulary:[{word:"play",meaning:"놀다, 게임하다 (동사)"},{word:"only after",meaning:"~한 후에만 (표현)"}], structure:"Only after ~는 조건 표현입니다.", pattern:"Only after + 주어 + 동사" },

// ===== Day 7: 정리정돈 =====
{ situation:"방 청소", dialogs:[{speaker:"엄마",icon:"👩",english:"Your room is messy. Please clean it up.",korean:"네 방이 지저분해. 정리해줘."},{speaker:"아이",icon:"😅",english:"I'll do it right now.",korean:"지금 바로 할게요."}], vocabulary:[{word:"messy",meaning:"지저분한 (형용사)"},{word:"clean up",meaning:"청소하다 (동사구)"}], structure:"Please + 동사원형은 정중한 부탁입니다.", pattern:"Please + 동사원형" },
{ situation:"장난감 정리", dialogs:[{speaker:"아빠",icon:"👨",english:"Put your toys away before dinner.",korean:"저녁 먹기 전에 장난감 치워."},{speaker:"아이",icon:"🧸",english:"Okay, I'm putting them away now.",korean:"네, 지금 치우고 있어요."}], vocabulary:[{word:"put away",meaning:"치우다 (동사구)"},{word:"before",meaning:"~전에 (전치사)"}], structure:"동사원형 + before ~는 시간 순서 지시입니다.", pattern:"동사원형 + before + 명사" },
{ situation:"정리 칭찬", dialogs:[{speaker:"엄마",icon:"👩",english:"Good job cleaning your room!",korean:"방 청소 잘했어!"},{speaker:"아이",icon:"😊",english:"Thanks! It looks much better now.",korean:"고마워요! 이제 훨씬 나아 보여요."}], vocabulary:[{word:"Good job",meaning:"잘했어 (칭찬)"},{word:"much better",meaning:"훨씬 더 나은 (비교급)"}], structure:"Good job + 동명사는 칭찬 표현입니다.", pattern:"Good job + ~ing" },

// ===== Day 8: 취침 준비 =====
{ situation:"이 닦기", dialogs:[{speaker:"엄마",icon:"👩",english:"It's time to brush your teeth.",korean:"이 닦을 시간이야."},{speaker:"아이",icon:"🪥",english:"Can I read one more chapter first?",korean:"한 챕터만 먼저 읽어도 돼요?"}], vocabulary:[{word:"brush teeth",meaning:"이를 닦다 (동사구)"},{word:"chapter",meaning:"챕터, 장 (명사)"}], structure:"It's time to ~는 관용 표현입니다.", pattern:"It's time to + 동사원형" },
{ situation:"잠옷 입기", dialogs:[{speaker:"아빠",icon:"👨",english:"Go put on your pajamas.",korean:"가서 잠옷 입어."},{speaker:"아이",icon:"👕",english:"Where are my pajamas?",korean:"제 잠옷 어디 있어요?"}], vocabulary:[{word:"put on",meaning:"입다 (동사구)"},{word:"pajamas",meaning:"잠옷 (명사)"}], structure:"Go + 동사원형은 명령입니다.", pattern:"Go + 동사원형" },
{ situation:"잘 자라는 인사", dialogs:[{speaker:"엄마",icon:"👩",english:"Sweet dreams, my love.",korean:"좋은 꿈 꿔, 우리 아가."},{speaker:"아이",icon:"😴",english:"Good night, Mom. I love you.",korean:"잘 자요, 엄마. 사랑해요."}], vocabulary:[{word:"Sweet dreams",meaning:"좋은 꿈 꿔 (취침 인사)"},{word:"Good night",meaning:"잘 자 (취침 인사)"}], structure:"Good night는 취침 인사입니다.", pattern:"Good night + 호칭" },

// ===== Day 9: 주말 계획 =====
{ situation:"주말 아침", dialogs:[{speaker:"아이",icon:"🌞",english:"What are we doing today?",korean:"오늘 뭐 할 거예요?"},{speaker:"아빠",icon:"👨",english:"Let's go to the park this afternoon.",korean:"오후에 공원 가자."}], vocabulary:[{word:"What are we doing?",meaning:"우리 뭐 할 거야? (계획 묻기)"},{word:"this afternoon",meaning:"오늘 오후 (시간 표현)"}], structure:"What are we ~ing?는 미래 계획을 묻습니다.", pattern:"What are we + ~ing?" },
{ situation:"공원 준비", dialogs:[{speaker:"엄마",icon:"👩",english:"Put on your jacket. It's cold outside.",korean:"재킷 입어. 밖이 추워."},{speaker:"아이",icon:"🧥",english:"Can I bring my soccer ball?",korean:"축구공 가져가도 돼요?"}], vocabulary:[{word:"outside",meaning:"밖에 (부사)"},{word:"bring",meaning:"가져가다 (동사)"}], structure:"It's + 형용사는 날씨 설명입니다.", pattern:"It's + 형용사" },
{ situation:"공원에서 놀기", dialogs:[{speaker:"아빠",icon:"👨",english:"Be careful on the slide!",korean:"미끄럼틀 조심해!"},{speaker:"아이",icon:"🛝",english:"This is so much fun!",korean:"너무 재밌어요!"}], vocabulary:[{word:"be careful",meaning:"조심하다 (동사구)"},{word:"so much fun",meaning:"너무 재밌는 (표현)"}], structure:"This is so + 형용사는 감탄 표현입니다.", pattern:"This is so + 형용사" },

// ===== Day 10: 장보기 =====
{ situation:"마트 가기", dialogs:[{speaker:"엄마",icon:"👩",english:"We need to buy some groceries.",korean:"장을 좀 봐야 해."},{speaker:"아이",icon:"🛒",english:"Can I push the shopping cart?",korean:"제가 카트 밀어도 돼요?"}], vocabulary:[{word:"groceries",meaning:"식료품 (명사)"},{word:"shopping cart",meaning:"쇼핑 카트 (명사)"}], structure:"We need to ~는 필요성 표현입니다.", pattern:"We need to + 동사원형" },
{ situation:"마트에서", dialogs:[{speaker:"아이",icon:"🍭",english:"Can I get some candy?",korean:"사탕 사도 돼요?"},{speaker:"아빠",icon:"👨",english:"Just one. Too much sugar isn't good for you.",korean:"하나만. 설탕 많이 먹으면 안 좋아."}], vocabulary:[{word:"candy",meaning:"사탕 (명사)"},{word:"isn't good for",meaning:"~에 안 좋은 (표현)"}], structure:"Too much + 명사는 '너무 많은 ~'입니다.", pattern:"Too much + 명사" },
{ situation:"장보기 후", dialogs:[{speaker:"엄마",icon:"👩",english:"Help me carry these bags.",korean:"이 가방들 나르는 거 도와줘."},{speaker:"아이",icon:"💪",english:"Sure! I'm strong enough!",korean:"네! 저 충분히 힘 세요!"}], vocabulary:[{word:"carry",meaning:"나르다 (동사)"},{word:"strong enough",meaning:"충분히 힘센 (표현)"}], structure:"형용사 + enough는 '충분히 ~한'입니다.", pattern:"형용사 + enough" },

// ===== Day 11: 날씨와 외출 =====
{ situation:"비 오는 날", dialogs:[{speaker:"아빠",icon:"👨",english:"Don't forget your umbrella.",korean:"우산 잊지 마."},{speaker:"아이",icon:"☔",english:"Can I wear my rain boots?",korean:"장화 신어도 돼요?"}], vocabulary:[{word:"umbrella",meaning:"우산 (명사)"},{word:"rain boots",meaning:"장화 (명사)"}], structure:"Don't forget ~는 주의 표현입니다.", pattern:"Don't forget + 명사" },
{ situation:"더운 날", dialogs:[{speaker:"엄마",icon:"👩",english:"It's very hot today. Drink lots of water.",korean:"오늘 너무 더워. 물 많이 마셔."},{speaker:"아이",icon:"💧",english:"Can we get ice cream later?",korean:"나중에 아이스크림 먹어도 돼요?"}], vocabulary:[{word:"lots of",meaning:"많은 (표현)"},{word:"later",meaning:"나중에 (부사)"}], structure:"명령문 + lots of는 권유입니다.", pattern:"동사원형 + lots of + 명사" },
{ situation:"추운 날", dialogs:[{speaker:"아빠",icon:"👨",english:"Put on your warm coat.",korean:"따뜻한 코트 입어."},{speaker:"아이",icon:"🧣",english:"Should I bring my gloves too?",korean:"장갑도 가져갈까요?"}], vocabulary:[{word:"warm",meaning:"따뜻한 (형용사)"},{word:"gloves",meaning:"장갑 (명사)"}], structure:"Should I ~?는 조언을 구하는 표현입니다.", pattern:"Should I + 동사원형?" },

// ===== Day 12: 친구 관계 =====
{ situation:"친구 이야기", dialogs:[{speaker:"엄마",icon:"👩",english:"Did you play with your friends today?",korean:"오늘 친구들이랑 놀았어?"},{speaker:"아이",icon:"😊",english:"Yes! We had so much fun!",korean:"네! 너무 재밌었어요!"}], vocabulary:[{word:"play with",meaning:"~와 놀다 (동사구)"},{word:"have fun",meaning:"재미있게 놀다 (표현)"}], structure:"Did you + 동사는 과거 경험을 묻습니다.", pattern:"Did you + 동사원형?" },
{ situation:"친구 초대", dialogs:[{speaker:"아이",icon:"🎉",english:"Can my friend come over today?",korean:"제 친구가 오늘 와도 돼요?"},{speaker:"아빠",icon:"👨",english:"Sure, but clean your room first.",korean:"그럼, 근데 방 먼저 청소해."}], vocabulary:[{word:"come over",meaning:"놀러 오다 (동사구)"},{word:"but",meaning:"하지만, 그러나 (접속사)"}], structure:"Can + 주어 + 동사는 허락을 구합니다.", pattern:"Can + 주어 + 동사원형?" },
{ situation:"친구와 싸움", dialogs:[{speaker:"아이",icon:"😢",english:"I had a fight with my friend.",korean:"친구랑 싸웠어요."},{speaker:"엄마",icon:"👩",english:"Why don't you say sorry?",korean:"미안하다고 말하는 게 어때?"}], vocabulary:[{word:"have a fight",meaning:"싸우다 (표현)"},{word:"Why don't you",meaning:"~하는 게 어때? (제안)"}], structure:"Why don't you ~는 부드러운 제안입니다.", pattern:"Why don't you + 동사원형?" },

// ===== Day 13: 건강과 안전 =====
{ situation:"손 씻기", dialogs:[{speaker:"엄마",icon:"👩",english:"Wash your hands before eating.",korean:"먹기 전에 손 씻어."},{speaker:"아이",icon:"🧼",english:"Okay, I'm washing them now.",korean:"네, 지금 씻고 있어요."}], vocabulary:[{word:"wash hands",meaning:"손을 씻다 (동사구)"},{word:"before eating",meaning:"먹기 전에 (시간 표현)"}], structure:"동사원형 + before ~는 순서를 나타냅니다.", pattern:"동사원형 + before + 동명사" },
{ situation:"아플 때", dialogs:[{speaker:"아이",icon:"🤒",english:"Mom, I don't feel well.",korean:"엄마, 몸이 안 좋아요."},{speaker:"엄마",icon:"👩",english:"Let me check your temperature.",korean:"체온 재볼게."}], vocabulary:[{word:"feel well",meaning:"몸 상태가 좋다 (표현)"},{word:"temperature",meaning:"체온 (명사)"}], structure:"don't feel well은 '몸이 안 좋다'는 표현입니다.", pattern:"주어 + don't feel well" },
{ situation:"약 먹기", dialogs:[{speaker:"아빠",icon:"👨",english:"Take this medicine after meals.",korean:"식후에 이 약 먹어."},{speaker:"아이",icon:"💊",english:"Does it taste bad?",korean:"맛이 안 좋아요?"}], vocabulary:[{word:"medicine",meaning:"약 (명사)"},{word:"after meals",meaning:"식후에 (시간 표현)"}], structure:"Take + 약 + after meals는 약 복용 지시입니다.", pattern:"Take + 명사 + after meals" }
    ];

    // ===== 상태 =====
    let currentSlide = 0;
    let startX = 0; let currentX = 0; let isDragging = false;
    const state = { showKorean: [false,false,false], showAnalysis:[false,false,false] };

    // ===== 유틸 =====
    function displayDate(){
      const today = new Date();
      const options = { year:'numeric', month:'long', day:'numeric', weekday:'long' };
      document.getElementById('todayDate').textContent = today.toLocaleDateString('ko-KR', options);
    }

    function getTodayConversations(){
      const today = new Date();
      const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
      const startIndex = (dayOfYear * 3) % dailyConversations.length;
      return [
        dailyConversations[startIndex % dailyConversations.length],
        dailyConversations[(startIndex + 1) % dailyConversations.length],
        dailyConversations[(startIndex + 2) % dailyConversations.length]
      ];
    }

    function createSlide(conv, index){
      const showK = state.showKorean[index];
      return `
        <div class="slide" data-slide-index="${index}">
          <div class="card">
            <div class="situation-tag">📍 ${conv.situation}</div>
            <div class="conversation">
              ${conv.dialogs.map(d => `
                <div class=\"dialog-item\">
                  <div class=\"speaker-icon\">${d.icon}</div>
                  <div class=\"dialog-content\">
                    <div class=\"speaker-label\">${d.speaker}</div>
                    <div class=\"english\">${d.english}</div>
                    <div class=\"korean ${showK ? '' : 'hidden'}\" data-korean=\"${index}\">${d.korean}</div>
                  </div>
                  <button class=\"speaker-btn\" onclick=\"speak('${d.english.replace(/'/g, "\\'")}')\">🔊</button>
                </div>
              `).join('')}
            </div>
            <button class="toggle-btn" data-btn-type="korean" data-btn-index="${index}" onclick="toggleKorean(${index})">한글 뜻 보기</button>
            <button class="toggle-btn" data-btn-type="analysis" data-btn-index="${index}" onclick="toggleAnalysis(${index})">단어·문법 분석 보기</button>
            <div class="analysis-section hidden" data-analysis="${index}">
              <div class="section-title">📖 핵심 단어</div>
              <div class="vocabulary-list">
                ${conv.vocabulary.map(v => `
                  <div class=\"vocab-item\"><div class=\"vocab-word\">${v.word}</div><div class=\"vocab-meaning\">${v.meaning}</div></div>
                `).join('')}
              </div>
            </div>
            <div class="analysis-section hidden" data-analysis="${index}">
              <div class="section-title">🔍 문장 구조 분석</div>
              <div class="structure-box"><div class="structure-text">${conv.structure}</div><div class="structure-pattern">패턴: ${conv.pattern}</div></div>
            </div>
          </div>
        </div>`;
    }

    function renderSlides(){
      const wrapper = document.getElementById('sliderWrapper');
      wrapper.innerHTML = getTodayConversations().map(createSlide).join('');
      updateSlidePosition();
    }

    function updateSlidePosition(){
      const wrapper = document.getElementById('sliderWrapper');
      const offset = -currentSlide * window.innerWidth; // 화면 너비 기준 이동
      wrapper.style.transform = `translateX(${offset}px)`;
      document.getElementById('progressText').textContent = `${currentSlide+1}/3`;
      document.querySelectorAll('.dot').forEach((dot, idx)=>dot.classList.toggle('active', idx===currentSlide));
    }

    function toggleKorean(index){
      state.showKorean[index] = !state.showKorean[index];
      const slide = document.querySelector(`[data-slide-index="${index}"]`);
      slide.querySelectorAll(`[data-korean="${index}"]`).forEach(el=>el.classList.toggle('hidden', !state.showKorean[index]));
      const btn = slide.querySelector(`[data-btn-type="korean"][data-btn-index="${index}"]`);
      if(btn) btn.textContent = state.showKorean[index] ? '한글 뜻 숨기기' : '한글 뜻 보기';
    }

    function toggleAnalysis(index){
      state.showAnalysis[index] = !state.showAnalysis[index];
      const slide = document.querySelector(`[data-slide-index="${index}"]`);
      slide.querySelectorAll(`[data-analysis="${index}"]`).forEach(s=>s.classList.toggle('hidden', !state.showAnalysis[index]));
      const btn = slide.querySelector(`[data-btn-type="analysis"][data-btn-index="${index}"]`);
      if(btn) btn.textContent = state.showAnalysis[index] ? '단어·문법 분석 숨기기' : '단어·문법 분석 보기';
    }

    function speak(text){ const u=new SpeechSynthesisUtterance(text); u.lang='en-US'; u.rate=.9; speechSynthesis.speak(u); }

    // 스와이프/드래그
    function handleTouchStart(e){ if(e.target.closest('button')) return; startX = e.touches[0].clientX; isDragging=true; document.getElementById('sliderWrapper').style.transition='none'; }
    function handleTouchMove(e){ if(!isDragging) return; currentX = e.touches[0].clientX; const diff=currentX-startX; const base=-currentSlide*window.innerWidth; document.getElementById('sliderWrapper').style.transform=`translateX(${base+diff}px)`; }
    function handleTouchEnd(){ if(!isDragging) return; isDragging=false; const diff=currentX-startX; const threshold=Math.min(80, window.innerWidth*0.2); const w=document.getElementById('sliderWrapper'); w.style.transition='transform .3s ease'; if(Math.abs(diff)>threshold){ if(diff>0 && currentSlide>0) currentSlide--; else if(diff<0 && currentSlide<2) currentSlide++; } updateSlidePosition(); startX=0; currentX=0; }
    function handleMouseDown(e){ if(e.target.closest('button')) return; startX=e.clientX; isDragging=true; document.getElementById('sliderWrapper').style.transition='none'; }
    function handleMouseMove(e){ if(!isDragging) return; e.preventDefault(); currentX=e.clientX; const diff=currentX-startX; const base=-currentSlide*window.innerWidth; document.getElementById('sliderWrapper').style.transform=`translateX(${base+diff}px)`; }
    function handleMouseUp(){ if(!isDragging) return; isDragging=false; const diff=currentX-startX; const threshold=Math.min(80, window.innerWidth*0.2); const w=document.getElementById('sliderWrapper'); w.style.transition='transform .3s ease'; if(Math.abs(diff)>threshold){ if(diff>0 && currentSlide>0) currentSlide--; else if(diff<0 && currentSlide<2) currentSlide++; } updateSlidePosition(); startX=0; currentX=0; }

    // 진행/스트릭
    function completeToday(){ const today=new Date().toDateString(); const completed=JSON.parse(localStorage.getItem('completedDays')||'[]'); if(!completed.includes(today)){ completed.push(today); localStorage.setItem('completedDays', JSON.stringify(completed)); updateStreak(); const btn=document.getElementById('checkBtn'); btn.textContent='오늘 학습 완료! 🎉'; btn.classList.add('completed'); btn.disabled=true; } }
    function updateStreak(){ const completed=JSON.parse(localStorage.getItem('completedDays')||'[]'); const sorted=completed.map(d=>new Date(d)).sort((a,b)=>b-a); let streak=0; const today=new Date(); today.setHours(0,0,0,0); for(let i=0;i<sorted.length;i++){ const check=new Date(today); check.setDate(check.getDate()-i); check.setHours(0,0,0,0); const has=sorted.some(d=>{d.setHours(0,0,0,0); return d.getTime()===check.getTime();}); if(has) streak++; else break; } document.getElementById('streakBadge').textContent=`🔥 연속 ${streak}일`; }

    // 초기화
    function init(){
      displayDate(); renderSlides(); updateStreak();
      const today=new Date().toDateString(); const completed=JSON.parse(localStorage.getItem('completedDays')||'[]');
      if(completed.includes(today)){ const btn=document.getElementById('checkBtn'); btn.textContent='오늘 학습 완료! 🎉'; btn.classList.add('completed'); btn.disabled=true; }
      const c=document.getElementById('sliderContainer');
      c.addEventListener('touchstart', handleTouchStart, {passive:true});
      c.addEventListener('touchmove', handleTouchMove, {passive:true});
      c.addEventListener('touchend', handleTouchEnd);
      c.addEventListener('mousedown', handleMouseDown);
      c.addEventListener('mousemove', handleMouseMove);
      c.addEventListener('mouseup', handleMouseUp);
      c.addEventListener('mouseleave', handleMouseUp);
      window.addEventListener('resize', updateSlidePosition);
    }
    init();
  </script>
</body>
</html>