<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Ïò§ÎäòÏùò ÏòÅÏñ¥ Î¨∏Ïû•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: pan-y;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .date {
            color: #667eea;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .streak {
            display: inline-block;
            background: #fff3cd;
            color: #856404;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .progress-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .progress-indicator {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }
        
        .progress-dots {
            display: flex;
            gap: 8px;
        }
        
        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #dee2e6;
            transition: all 0.3s;
        }
        
        .dot.active {
            background: #667eea;
            transform: scale(1.3);
        }
        
        .slider-container {
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            touch-action: pan-x;
            overscroll-behavior: contain;
            -webkit-overflow-scrolling: touch;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .slider-wrapper {
            display: flex;
            transition: transform 0.3s ease;
            touch-action: pan-x;
            will-change: transform;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .slide {
            min-width: 100%;
            flex-shrink: 0;
            padding: 0 2px;
        }
        
        .card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            position: relative;
        }
        
        .situation-tag {
            display: inline-block;
            background: #e7f3ff;
            color: #0066cc;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .conversation {
            margin-bottom: 20px;
        }
        
        .dialog-item {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .speaker-icon {
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .dialog-content {
            flex: 1;
        }
        
        .speaker-label {
            font-size: 12px;
            font-weight: 600;
            color: #666;
            margin-bottom: 4px;
        }
        
        .english {
            font-size: 17px;
            font-weight: 600;
            color: #333;
            line-height: 1.5;
            margin-bottom: 8px;
        }
        
        .korean {
            font-size: 15px;
            color: #666;
            line-height: 1.5;
        }
        
        .hidden {
            display: none !important;
        }
        
        .speaker-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        
        .speaker-btn:hover {
            transform: scale(1.1);
        }
        
        .speaker-btn:active {
            transform: scale(0.95);
        }
        
        .toggle-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: block;
            margin: 15px auto 10px;
            transition: all 0.3s;
        }
        
        .toggle-btn:hover {
            background: #667eea;
            color: white;
        }
        
        .analysis-section {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .vocabulary-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .vocab-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
        
        .vocab-word {
            font-weight: 600;
            color: #333;
            font-size: 14px;
            margin-bottom: 3px;
        }
        
        .vocab-meaning {
            color: #666;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .structure-box {
            background: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #ffc107;
        }
        
        .structure-text {
            color: #856404;
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .structure-pattern {
            background: white;
            padding: 8px;
            border-radius: 6px;
            font-weight: 600;
            color: #333;
            font-size: 13px;
        }
        
        .check-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .check-btn:hover {
            background: #218838;
        }
        
        .check-btn.completed {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .tip {
            background: #e7f3ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 13px;
            color: #555;
        }
        
        .tip-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }

        .swipe-hint {
            text-align: center;
            color: #999;
            font-size: 12px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .arrow {
            font-size: 20px;
            animation: bounce 1.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(0); opacity: 0.5; }
            50% { transform: translateX(-5px); opacity: 1; }
        }

        .arrow.right {
            animation: bounceRight 1.5s infinite;
        }

        @keyframes bounceRight {
            0%, 100% { transform: translateX(0); opacity: 0.5; }
            50% { transform: translateX(5px); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="date" id="todayDate"></div>
            <div class="title">üí¨ Ïò§ÎäòÏùò ÏòÅÏñ¥ ÎåÄÌôî</div>
            <div class="subtitle">ÌïôÎ∂ÄÎ™®-ÏûêÎÖÄ ÏùºÏÉÅ ÌëúÌòÑ</div>
            <div class="streak" id="streakBadge">üî• Ïó∞ÏÜç 0Ïùº</div>
        </div>
        
        <div class="progress-container">
            <div class="progress-indicator" id="progressText">1/3</div>
            <div class="progress-dots">
                <div class="dot active" data-index="0"></div>
                <div class="dot" data-index="1"></div>
                <div class="dot" data-index="2"></div>
            </div>
        </div>
        
        <div class="slider-container" id="sliderContainer">
            <div class="slider-wrapper" id="sliderWrapper"></div>
        </div>
        
        <div class="swipe-hint">
            <span class="arrow">‚Üê</span>
            <span>Ï¢åÏö∞Î°ú Ïä§ÏôÄÏù¥ÌîÑÌïòÏó¨ Ïù¥Îèô</span>
            <span class="arrow right">‚Üí</span>
        </div>
        
        <button class="check-btn" id="checkBtn" onclick="completeToday()">Ïò§Îäò ÌïôÏäµ ÏôÑÎ£å! ‚úÖ</button>
        
        <div class="tip">
            <div class="tip-title">üí° ÌïôÏäµ TIP</div>
            <div>ÏûêÎÖÄÏôÄ Ìï®Íªò ÏÜåÎ¶¨ ÎÇ¥Ïñ¥ ÏùΩÏñ¥Î≥¥ÏÑ∏Ïöî. Ïã§Ï†ú ÏÉÅÌô©ÏóêÏÑú ÏûêÏó∞Ïä§ÎüΩÍ≤å ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎäî ÌëúÌòÑÎì§ÏûÖÎãàÎã§!</div>
        </div>
    </div>

    <script>
        // ===== Data =====
        const dailyConversations = [
            {
                situation: "ÏïÑÏπ®Ïóê Íπ®Ïö∞Í∏∞",
                dialogs: [
                    { speaker: "ÏóÑÎßà", icon: "üë©", english: "Time to wake up, sweetie!", korean: "ÏùºÏñ¥ÎÇ† ÏãúÍ∞ÑÏù¥Ïïº, ÏñòÏïº!" },
                    { speaker: "ÏïÑÏù¥", icon: "üò¥", english: "Five more minutes, please.", korean: "5Î∂ÑÎßå ÎçîÏöî, Ï†úÎ∞úÏöî." }
                ],
                vocabulary: [
                    { word: "wake up", meaning: "ÏùºÏñ¥ÎÇòÎã§ (ÎèôÏÇ¨Íµ¨)" },
                    { word: "sweetie", meaning: "ÏñòÏïº, ÏûêÍ∏∞Ïïº (Ïï†Ïπ≠)" }
                ],
                structure: "Time to + ÎèôÏÇ¨ÏõêÌòï: '~Ìï† ÏãúÍ∞ÑÏù¥Ïïº'ÎùºÎäî Í¥ÄÏö©ÌëúÌòÑÏûÖÎãàÎã§.",
                pattern: "Time to + ÎèôÏÇ¨ÏõêÌòï"
            },
            {
                situation: "ÏïÑÏπ® ÏãùÏÇ¨ Ï§ÄÎπÑ",
                dialogs: [
                    { speaker: "ÏïÑÎπ†", icon: "üë®", english: "What would you like for breakfast?", korean: "ÏïÑÏπ®ÏúºÎ°ú Î≠ê Î®πÍ≥† Ïã∂Ïñ¥?" },
                    { speaker: "ÏïÑÏù¥", icon: "üßí", english: "Can I have cereal with milk?", korean: "Ïö∞Ïú†Îûë ÏãúÎ¶¨Ïñº Î®πÏñ¥ÎèÑ ÎèºÏöî?" }
                ],
                vocabulary: [
                    { word: "would like", meaning: "~ÌïòÍ≥† Ïã∂Îã§ (wantÎ≥¥Îã§ Ï†ïÏ§ëÌïú ÌëúÌòÑ)" },
                    { word: "cereal", meaning: "ÏãúÎ¶¨Ïñº (Î™ÖÏÇ¨)" }
                ],
                structure: "What would you like for ~?Îäî '~Î°ú Î¨¥ÏóáÏùÑ ÏõêÌïòÎãà?'ÎùºÎäî Ï†ïÏ§ëÌïú ÏßàÎ¨∏ÏûÖÎãàÎã§.",
                pattern: "What would you like for + Î™ÖÏÇ¨?"
            },
            {
                situation: "Îì±Íµê Ï§ÄÎπÑ",
                dialogs: [
                    { speaker: "ÏóÑÎßà", icon: "üë©", english: "Don't forget your homework.", korean: "ÏàôÏ†ú ÏûäÏßÄ Îßà." },
                    { speaker: "ÏïÑÏù¥", icon: "üéí", english: "It's already in my backpack.", korean: "Ïù¥ÎØ∏ Í∞ÄÎ∞©Ïóê ÎÑ£ÏóàÏñ¥Ïöî." }
                ],
                vocabulary: [
                    { word: "forget", meaning: "ÏûäÎã§ (ÎèôÏÇ¨)" },
                    { word: "backpack", meaning: "Ï±ÖÍ∞ÄÎ∞© (Î™ÖÏÇ¨)" }
                ],
                structure: "Don't forgetÎäî 'ÏûäÏßÄ Îßà'ÎùºÎäî Î™ÖÎ†πÎ¨∏ÏûÖÎãàÎã§.",
                pattern: "Don't forget + Î™ÖÏÇ¨"
            }
        ];

        // ===== State =====
        let currentSlide = 0;
        let startX = 0;
        let currentX = 0;
        let isDragging = false;
        const state = {
            showKorean: [false, false, false],
            showAnalysis: [false, false, false]
        };

        // ===== Helpers =====
        function displayDate() {
            const today = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            const dateStr = today.toLocaleDateString('ko-KR', options);
            document.getElementById('todayDate').textContent = dateStr;
        }

        function getTodayConversations() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            const startIndex = (dayOfYear * 3) % dailyConversations.length;
            return [
                dailyConversations[startIndex % dailyConversations.length],
                dailyConversations[(startIndex + 1) % dailyConversations.length],
                dailyConversations[(startIndex + 2) % dailyConversations.length]
            ];
        }

        function createSlide(conv, index) {
            const showK = state.showKorean[index];
            return `
                <div class="slide" data-slide-index="${index}">
                    <div class="card">
                        <div class="situation-tag">üìç ${conv.situation}</div>
                        <div class="conversation">
                            ${conv.dialogs.map(dialog => `
                                <div class="dialog-item">
                                    <div class="speaker-icon">${dialog.icon}</div>
                                    <div class="dialog-content">
                                        <div class="speaker-label">${dialog.speaker}</div>
                                        <div class="english">${dialog.english}</div>
                                        <div class="korean ${showK ? '' : 'hidden'}" data-korean="${index}">${dialog.korean}</div>
                                    </div>
                                    <button class="speaker-btn" onclick="speak('${dialog.english.replace(/'/g, "\\'")}')">üîä</button>
                                </div>
                            `).join('')}
                        </div>
                        <button class="toggle-btn" data-btn-type="korean" data-btn-index="${index}" onclick="toggleKorean(${index})">ÌïúÍ∏Ä Îúª Î≥¥Í∏∞</button>
                        <button class="toggle-btn" data-btn-type="analysis" data-btn-index="${index}" onclick="toggleAnalysis(${index})">Îã®Ïñ¥¬∑Î¨∏Î≤ï Î∂ÑÏÑù Î≥¥Í∏∞</button>
                        <div class="analysis-section hidden" data-analysis="${index}">
                            <div class="section-title">üìñ ÌïµÏã¨ Îã®Ïñ¥</div>
                            <div class="vocabulary-list">
                                ${conv.vocabulary.map(v => `
                                    <div class="vocab-item">
                                        <div class="vocab-word">${v.word}</div>
                                        <div class="vocab-meaning">${v.meaning}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="analysis-section hidden" data-analysis="${index}">
                            <div class="section-title">üîç Î¨∏Ïû• Íµ¨Ï°∞ Î∂ÑÏÑù</div>
                            <div class="structure-box">
                                <div class="structure-text">${conv.structure}</div>
                                <div class="structure-pattern">Ìå®ÌÑ¥: ${conv.pattern}</div>
                            </div>
                        </div>
                    </div>
                </div>`;
        }

        function renderSlides() {
            const conversations = getTodayConversations();
            const wrapper = document.getElementById('sliderWrapper');
            wrapper.innerHTML = conversations.map((conv, idx) => createSlide(conv, idx)).join('');
            updateSlidePosition();
        }

        function updateSlidePosition() {
            const wrapper = document.getElementById('sliderWrapper');
            const container = document.getElementById('sliderContainer');
            const offset = -currentSlide * container.clientWidth;
            wrapper.style.transform = `translateX(${offset}px)`;
            document.getElementById('progressText').textContent = `${currentSlide + 1}/3`;
            document.querySelectorAll('.dot').forEach((dot, idx) => {
                dot.classList.toggle('active', idx === currentSlide);
            });
        }

        function toggleKorean(index) {
            state.showKorean[index] = !state.showKorean[index];
            const slide = document.querySelector(`[data-slide-index="${index}"]`);
            const koreanEls = slide.querySelectorAll(`[data-korean="${index}"]`);
            const btn = slide.querySelector(`[data-btn-type="korean"][data-btn-index="${index}"]`);
            koreanEls.forEach(el => el.classList.toggle('hidden', !state.showKorean[index]));
            if (btn) btn.textContent = state.showKorean[index] ? 'ÌïúÍ∏Ä Îúª Ïà®Í∏∞Í∏∞' : 'ÌïúÍ∏Ä Îúª Î≥¥Í∏∞';
        }

        function toggleAnalysis(index) {
            state.showAnalysis[index] = !state.showAnalysis[index];
            const slide = document.querySelector(`[data-slide-index="${index}"]`);
            const sections = slide.querySelectorAll(`[data-analysis="${index}"]`);
            const btn = slide.querySelector(`[data-btn-type="analysis"][data-btn-index="${index}"]`);
            sections.forEach(s => s.classList.toggle('hidden', !state.showAnalysis[index]));
            if (btn) btn.textContent = state.showAnalysis[index] ? 'Îã®Ïñ¥¬∑Î¨∏Î≤ï Î∂ÑÏÑù Ïà®Í∏∞Í∏∞' : 'Îã®Ïñ¥¬∑Î¨∏Î≤ï Î∂ÑÏÑù Î≥¥Í∏∞';
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }

        // ===== Swipe / Drag Handlers =====
        function handleTouchStart(e) {
            if (e.target.tagName === 'BUTTON' || e.target.closest('button')) return;
            startX = e.touches[0].clientX;
            isDragging = true;
            document.getElementById('sliderWrapper').style.transition = 'none';
        }
        function handleTouchMove(e) {
            if (!isDragging) return;
            const container = document.getElementById('sliderContainer');
            currentX = e.touches[0].clientX;
            const diff = currentX - startX;
            if (Math.abs(diff) < 3) return;
            const base = -currentSlide * container.clientWidth;
            document.getElementById('sliderWrapper').style.transform = `translateX(${base + diff}px)`;
        }
        function handleTouchEnd() {
            if (!isDragging) return;
            isDragging = false;
            const container = document.getElementById('sliderContainer');
            const diff = currentX - startX;
            const threshold = Math.min(80, container.clientWidth * 0.2);
            const wrapper = document.getElementById('sliderWrapper');
            wrapper.style.transition = 'transform 0.3s ease';
            if (Math.abs(diff) > threshold) {
                if (diff > 0 && currentSlide > 0) currentSlide--; else if (diff < 0 && currentSlide < 2) currentSlide++;
            }
            updateSlidePosition();
            startX = 0; currentX = 0;
        }

        function handleMouseDown(e) {
            if (e.target.tagName === 'BUTTON' || e.target.closest('button')) return;
            startX = e.clientX;
            isDragging = true;
            document.getElementById('sliderWrapper').style.transition = 'none';
        }
        function handleMouseMove(e) {
            if (!isDragging) return;
            e.preventDefault();
            const container = document.getElementById('sliderContainer');
            currentX = e.clientX;
            const diff = currentX - startX;
            if (Math.abs(diff) < 3) return;
            const base = -currentSlide * container.clientWidth;
            document.getElementById('sliderWrapper').style.transform = `translateX(${base + diff}px)`;
        }
        function handleMouseUp() {
            if (!isDragging) return;
            isDragging = false;
            const container = document.getElementById('sliderContainer');
            const diff = currentX - startX;
            const threshold = Math.min(80, container.clientWidth * 0.2);
            const wrapper = document.getElementById('sliderWrapper');
            wrapper.style.transition = 'transform 0.3s ease';
            if (Math.abs(diff) > threshold) {
                if (diff > 0 && currentSlide > 0) currentSlide--; else if (diff < 0 && currentSlide < 2) currentSlide++;
            }
            updateSlidePosition();
            startX = 0; currentX = 0;
        }

        // ===== Progress / Streak =====
        function completeToday() {
            const today = new Date().toDateString();
            const completed = JSON.parse(localStorage.getItem('completedDays') || '[]');
            if (!completed.includes(today)) {
                completed.push(today);
                localStorage.setItem('completedDays', JSON.stringify(completed));
                updateStreak();
                const btn = document.getElementById('checkBtn');
                btn.textContent = 'Ïò§Îäò ÌïôÏäµ ÏôÑÎ£å! üéâ';
                btn.classList.add('completed');
                btn.disabled = true;
            }
        }
        function updateStreak() {
            const completed = JSON.parse(localStorage.getItem('completedDays') || '[]');
            const sorted = completed.map(d => new Date(d)).sort((a,b)=>b-a);
            let streak = 0;
            const today = new Date();
            today.setHours(0,0,0,0);
            for (let i=0; i<sorted.length; i++) {
                const checkDate = new Date(today);
                checkDate.setDate(checkDate.getDate() - i);
                checkDate.setHours(0,0,0,0);
                const hasDate = sorted.some(d => { d.setHours(0,0,0,0); return d.getTime() === checkDate.getTime(); });
                if (hasDate) streak++; else break;
            }
            document.getElementById('streakBadge').textContent = `üî• Ïó∞ÏÜç ${streak}Ïùº`;
        }

        // ===== Init =====
        function init() {
            displayDate();
            renderSlides();
            updateStreak();

            const today = new Date().toDateString();
            const completed = JSON.parse(localStorage.getItem('completedDays') || '[]');
            if (completed.includes(today)) {
                const btn = document.getElementById('checkBtn');
                btn.textContent = 'Ïò§Îäò ÌïôÏäµ ÏôÑÎ£å! üéâ';
                btn.classList.add('completed');
                btn.disabled = true;
            }

            const container = document.getElementById('sliderContainer');
            container.addEventListener('touchstart', handleTouchStart, { passive: true });
            container.addEventListener('touchmove', handleTouchMove, { passive: true });
            container.addEventListener('touchend', handleTouchEnd);
            container.addEventListener('mousedown', handleMouseDown);
            container.addEventListener('mousemove', handleMouseMove);
            container.addEventListener('mouseup', handleMouseUp);
            container.addEventListener('mouseleave', handleMouseUp);

            // ÌôîÎ©¥ ÌöåÏ†Ñ/Î¶¨ÏÇ¨Ïù¥Ï¶à Ïãú ÌòÑÏû¨ Ïä¨ÎùºÏù¥Îìú Ï†ïÎ†¨ Î≥¥Ï†ï
            window.addEventListener('resize', updateSlidePosition);
        }
        init();
    </script>
</body>
</html>
