<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>오늘의 영어 문장 (전체화면 복원)</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #222;
    }

    .app-wrapper {
      width: 100vw; height: 100vh;
      display: flex; flex-direction: column;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
    }

    /* Header */
    .header { text-align: center; color: #fff; padding: 16px 20px 8px; }
    .date { opacity: .95; font-size: 14px; font-weight: 600; margin-bottom: 6px; }
    .title { font-size: 22px; font-weight: 800; }
    .subtitle { font-size: 13px; opacity: .95; margin-top: 6px; }
    .streak { display: inline-block; margin-top: 10px; background: #fff3cd; color:#856404; padding:4px 12px; border-radius: 16px; font-size: 13px; font-weight: 700; }

    /* Progress */
    .progress-container { display:flex; align-items:center; justify-content:center; gap:14px; padding: 10px 20px 6px; }
    .progress-indicator { color:#fff; font-weight:800; }
    .progress-dots { display:flex; gap:8px; }
    .dot { width:10px; height:10px; border-radius:50%; background:#dae1f7; opacity:.9; transition:.2s; }
    .dot.active { background:#fff; transform: scale(1.25); }

    /* Slider area: full width, inner content 90% (5% margins) */
    .slider-outer { flex: 1 1 auto; display:flex; align-items:center; justify-content:center; }
    .slider-container { position: relative; width: 100vw; overflow: hidden; }
    .slider-wrapper { display:flex; transition: transform .3s ease; height: 100%; will-change: transform; }
    .slide { min-width: 100vw; padding: 0 5vw; display:flex; align-items:stretch; justify-content:center; }

    /* Card */
    .card { background:#fff; width:100%; max-width:700px; border-radius:16px; padding:22px; box-shadow: 0 14px 40px rgba(0,0,0,.25); }
    .situation-tag { display:inline-block; background:#e7f3ff; color:#0066cc; padding:5px 12px; border-radius:14px; font-size:12px; font-weight:700; margin-bottom:12px; }
    .conversation { margin-bottom: 16px; }
    .dialog-item { display:flex; align-items:flex-start; gap:10px; margin-bottom: 14px; }
    .speaker-icon { font-size:22px; flex-shrink:0; }
    .dialog-content { flex:1; }
    .speaker-label { font-size:12px; font-weight:700; color:#666; margin-bottom:4px; }
    .english { font-size:17px; font-weight:700; color:#333; line-height:1.5; margin-bottom:6px; }
    .korean { font-size:15px; color:#666; line-height:1.5; }
    .hidden { display:none !important; }

    .speaker-btn { background:#667eea; color:#fff; border:none; border-radius:50%; width:36px; height:36px; font-size:16px; cursor:pointer; flex-shrink:0; transition: transform .2s; }
    .speaker-btn:active { transform: scale(.95); }

    .toggle-btn { background:#fff; border:2px solid #667eea; color:#667eea; padding:10px 16px; border-radius:12px; cursor:pointer; font-size:14px; font-weight:700; display:block; margin: 10px auto 6px; transition:.2s; }
    .toggle-btn:hover { background:#667eea; color:#fff; }

    .analysis-section { background:#fff; border:2px solid #e9ecef; border-radius:12px; padding:14px; margin-top:12px; }
    .section-title { font-size:14px; font-weight:800; color:#667eea; margin-bottom:10px; display:flex; align-items:center; gap:6px; }
    .vocabulary-list { display:flex; flex-direction:column; gap:10px; }
    .vocab-item { background:#f8f9fa; padding:10px; border-radius:8px; border-left:3px solid #667eea; }
    .vocab-word { font-weight:800; color:#333; font-size:14px; margin-bottom:3px; }
    .vocab-meaning { color:#666; font-size:13px; line-height:1.5; }
    .structure-box { background:#fff3cd; padding:12px; border-radius:8px; border-left:3px solid #ffc107; }
    .structure-text { color:#856404; font-size:13px; line-height:1.6; margin-bottom:8px; }
    .structure-pattern { background:#fff; padding:8px; border-radius:6px; font-weight:800; color:#333; font-size:13px; }

    .swipe-hint { text-align:center; color:#f0f3ff; font-size:12px; margin: 6px 0 0; display:flex; align-items:center; justify-content:center; gap:8px; }
    .arrow { font-size:18px; animation: bounce 1.5s infinite; }
    @keyframes bounce { 0%,100%{transform:translateX(0);opacity:.6;} 50%{transform:translateX(-4px);opacity:1;} }
    .arrow.right { animation: bounceRight 1.5s infinite; }
    @keyframes bounceRight { 0%,100%{transform:translateX(0);opacity:.6;} 50%{transform:translateX(4px);opacity:1;} }

    .footer { padding: 10px 16px 16px; }
    .check-btn { background:#28a745; color:#fff; border:none; padding:14px; border-radius:12px; cursor:pointer; font-size:16px; font-weight:800; width: min(700px, 90vw); margin: 10px auto 0; display:block; }
    .check-btn.completed { background:#6c757d; cursor:not-allowed; }
    .tip { background:#e7f3ff; border-left:4px solid #667eea; padding:12px; border-radius:8px; margin: 10px auto 0; font-size:13px; color:#444; width: min(700px, 90vw); }
    .tip-title { font-weight:800; color:#667eea; margin-bottom:6px; }

    @media (max-width: 768px){ .english{font-size:16px;} .speaker-btn{width:32px;height:32px;} .card{padding:18px;} }
  </style>
</head>
<body>
  <div class="app-wrapper">
    <!-- Header -->
    <div class="header">
      <div class="date" id="todayDate"></div>
      <div class="title">💬 오늘의 영어 대화</div>
      <div class="subtitle">학부모-자녀 일상 표현</div>
      <div class="streak" id="streakBadge">🔥 연속 0일</div>
    </div>

    <!-- Progress -->
    <div class="progress-container">
      <div class="progress-indicator" id="progressText">1/3</div>
      <div class="progress-dots">
        <div class="dot active" data-index="0"></div>
        <div class="dot" data-index="1"></div>
        <div class="dot" data-index="2"></div>
      </div>
    </div>

    <!-- Slider (full width; inner 90%) -->
    <div class="slider-outer">
      <div class="slider-container" id="sliderContainer">
        <div class="slider-wrapper" id="sliderWrapper"></div>
      </div>
    </div>

    <div class="swipe-hint"><span class="arrow">←</span> 좌우로 스와이프하여 이동 <span class="arrow right">→</span></div>

    <!-- Footer: actions -->
    <div class="footer">
      <button class="check-btn" id="checkBtn" onclick="completeToday()">오늘 학습 완료! ✅</button>
      <div class="tip">
        <div class="tip-title">💡 학습 TIP</div>
        <div>자녀와 함께 소리 내어 읽어보세요. 실제 상황에서 자연스럽게 사용할 수 있는 표현들입니다!</div>
      </div>
    </div>
  </div>

  <script>
    // ===== 콘텐츠 데이터 =====
    const dailyConversations = [
      {
        situation: "아침에 깨우기",
        dialogs: [
          { speaker: "엄마", icon: "👩", english: "Time to wake up, sweetie!", korean: "일어날 시간이야, 얘야!" },
          { speaker: "아이", icon: "😴", english: "Five more minutes, please.", korean: "5분만 더요, 제발요." }
        ],
        vocabulary: [
          { word: "wake up", meaning: "일어나다 (동사구)" },
          { word: "sweetie", meaning: "얘야, 자기야 (애칭)" }
        ],
        structure: "Time to + 동사원형: '~할 시간이야'라는 관용표현입니다.",
        pattern: "Time to + 동사원형"
      },
      {
        situation: "아침 식사 준비",
        dialogs: [
          { speaker: "아빠", icon: "👨", english: "What would you like for breakfast?", korean: "아침으로 뭐 먹고 싶어?" },
          { speaker: "아이", icon: "🧒", english: "Can I have cereal with milk?", korean: "우유랑 시리얼 먹어도 돼요?" }
        ],
        vocabulary: [
          { word: "would like", meaning: "~하고 싶다 (want보다 정중한 표현)" },
          { word: "cereal", meaning: "시리얼 (명사)" }
        ],
        structure: "What would you like for ~?는 '~로 무엇을 원하니?'라는 정중한 질문입니다.",
        pattern: "What would you like for + 명사?"
      },
      {
        situation: "등교 준비",
        dialogs: [
          { speaker: "엄마", icon: "👩", english: "Don't forget your homework.", korean: "숙제 잊지 마." },
          { speaker: "아이", icon: "🎒", english: "It's already in my backpack.", korean: "이미 가방에 넣었어요." }
        ],
        vocabulary: [
          { word: "forget", meaning: "잊다 (동사)" },
          { word: "backpack", meaning: "책가방 (명사)" }
        ],
        structure: "Don't forget는 '잊지 마'라는 명령문입니다.",
        pattern: "Don't forget + 명사"
      }
    ];

    // ===== 상태 =====
    let currentSlide = 0;
    let startX = 0; let currentX = 0; let isDragging = false;
    const state = { showKorean: [false,false,false], showAnalysis:[false,false,false] };

    // ===== 유틸 =====
    function displayDate(){
      const today = new Date();
      const options = { year:'numeric', month:'long', day:'numeric', weekday:'long' };
      document.getElementById('todayDate').textContent = today.toLocaleDateString('ko-KR', options);
    }

    function getTodayConversations(){
      const today = new Date();
      const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
      const startIndex = (dayOfYear * 3) % dailyConversations.length;
      return [
        dailyConversations[startIndex % dailyConversations.length],
        dailyConversations[(startIndex + 1) % dailyConversations.length],
        dailyConversations[(startIndex + 2) % dailyConversations.length]
      ];
    }

    function createSlide(conv, index){
      const showK = state.showKorean[index];
      return `
        <div class="slide" data-slide-index="${index}">
          <div class="card">
            <div class="situation-tag">📍 ${conv.situation}</div>
            <div class="conversation">
              ${conv.dialogs.map(d => `
                <div class=\"dialog-item\">
                  <div class=\"speaker-icon\">${d.icon}</div>
                  <div class=\"dialog-content\">
                    <div class=\"speaker-label\">${d.speaker}</div>
                    <div class=\"english\">${d.english}</div>
                    <div class=\"korean ${showK ? '' : 'hidden'}\" data-korean=\"${index}\">${d.korean}</div>
                  </div>
                  <button class=\"speaker-btn\" onclick=\"speak('${d.english.replace(/'/g, "\\'")}')\">🔊</button>
                </div>
              `).join('')}
            </div>
            <button class="toggle-btn" data-btn-type="korean" data-btn-index="${index}" onclick="toggleKorean(${index})">한글 뜻 보기</button>
            <button class="toggle-btn" data-btn-type="analysis" data-btn-index="${index}" onclick="toggleAnalysis(${index})">단어·문법 분석 보기</button>
            <div class="analysis-section hidden" data-analysis="${index}">
              <div class="section-title">📖 핵심 단어</div>
              <div class="vocabulary-list">
                ${conv.vocabulary.map(v => `
                  <div class=\"vocab-item\"><div class=\"vocab-word\">${v.word}</div><div class=\"vocab-meaning\">${v.meaning}</div></div>
                `).join('')}
              </div>
            </div>
            <div class="analysis-section hidden" data-analysis="${index}">
              <div class="section-title">🔍 문장 구조 분석</div>
              <div class="structure-box"><div class="structure-text">${conv.structure}</div><div class="structure-pattern">패턴: ${conv.pattern}</div></div>
            </div>
          </div>
        </div>`;
    }

    function renderSlides(){
      const wrapper = document.getElementById('sliderWrapper');
      wrapper.innerHTML = getTodayConversations().map(createSlide).join('');
      updateSlidePosition();
    }

    function updateSlidePosition(){
      const wrapper = document.getElementById('sliderWrapper');
      const offset = -currentSlide * window.innerWidth; // 화면 너비 기준 이동
      wrapper.style.transform = `translateX(${offset}px)`;
      document.getElementById('progressText').textContent = `${currentSlide+1}/3`;
      document.querySelectorAll('.dot').forEach((dot, idx)=>dot.classList.toggle('active', idx===currentSlide));
    }

    function toggleKorean(index){
      state.showKorean[index] = !state.showKorean[index];
      const slide = document.querySelector(`[data-slide-index="${index}"]`);
      slide.querySelectorAll(`[data-korean="${index}"]`).forEach(el=>el.classList.toggle('hidden', !state.showKorean[index]));
      const btn = slide.querySelector(`[data-btn-type="korean"][data-btn-index="${index}"]`);
      if(btn) btn.textContent = state.showKorean[index] ? '한글 뜻 숨기기' : '한글 뜻 보기';
    }

    function toggleAnalysis(index){
      state.showAnalysis[index] = !state.showAnalysis[index];
      const slide = document.querySelector(`[data-slide-index="${index}"]`);
      slide.querySelectorAll(`[data-analysis="${index}"]`).forEach(s=>s.classList.toggle('hidden', !state.showAnalysis[index]));
      const btn = slide.querySelector(`[data-btn-type="analysis"][data-btn-index="${index}"]`);
      if(btn) btn.textContent = state.showAnalysis[index] ? '단어·문법 분석 숨기기' : '단어·문법 분석 보기';
    }

    function speak(text){ const u=new SpeechSynthesisUtterance(text); u.lang='en-US'; u.rate=.9; speechSynthesis.speak(u); }

    // 스와이프/드래그
    function handleTouchStart(e){ if(e.target.closest('button')) return; startX = e.touches[0].clientX; isDragging=true; document.getElementById('sliderWrapper').style.transition='none'; }
    function handleTouchMove(e){ if(!isDragging) return; currentX = e.touches[0].clientX; const diff=currentX-startX; const base=-currentSlide*window.innerWidth; document.getElementById('sliderWrapper').style.transform=`translateX(${base+diff}px)`; }
    function handleTouchEnd(){ if(!isDragging) return; isDragging=false; const diff=currentX-startX; const threshold=Math.min(80, window.innerWidth*0.2); const w=document.getElementById('sliderWrapper'); w.style.transition='transform .3s ease'; if(Math.abs(diff)>threshold){ if(diff>0 && currentSlide>0) currentSlide--; else if(diff<0 && currentSlide<2) currentSlide++; } updateSlidePosition(); startX=0; currentX=0; }
    function handleMouseDown(e){ if(e.target.closest('button')) return; startX=e.clientX; isDragging=true; document.getElementById('sliderWrapper').style.transition='none'; }
    function handleMouseMove(e){ if(!isDragging) return; e.preventDefault(); currentX=e.clientX; const diff=currentX-startX; const base=-currentSlide*window.innerWidth; document.getElementById('sliderWrapper').style.transform=`translateX(${base+diff}px)`; }
    function handleMouseUp(){ if(!isDragging) return; isDragging=false; const diff=currentX-startX; const threshold=Math.min(80, window.innerWidth*0.2); const w=document.getElementById('sliderWrapper'); w.style.transition='transform .3s ease'; if(Math.abs(diff)>threshold){ if(diff>0 && currentSlide>0) currentSlide--; else if(diff<0 && currentSlide<2) currentSlide++; } updateSlidePosition(); startX=0; currentX=0; }

    // 진행/스트릭
    function completeToday(){ const today=new Date().toDateString(); const completed=JSON.parse(localStorage.getItem('completedDays')||'[]'); if(!completed.includes(today)){ completed.push(today); localStorage.setItem('completedDays', JSON.stringify(completed)); updateStreak(); const btn=document.getElementById('checkBtn'); btn.textContent='오늘 학습 완료! 🎉'; btn.classList.add('completed'); btn.disabled=true; } }
    function updateStreak(){ const completed=JSON.parse(localStorage.getItem('completedDays')||'[]'); const sorted=completed.map(d=>new Date(d)).sort((a,b)=>b-a); let streak=0; const today=new Date(); today.setHours(0,0,0,0); for(let i=0;i<sorted.length;i++){ const check=new Date(today); check.setDate(check.getDate()-i); check.setHours(0,0,0,0); const has=sorted.some(d=>{d.setHours(0,0,0,0); return d.getTime()===check.getTime();}); if(has) streak++; else break; } document.getElementById('streakBadge').textContent=`🔥 연속 ${streak}일`; }

    // 초기화
    function init(){
      displayDate(); renderSlides(); updateStreak();
      const today=new Date().toDateString(); const completed=JSON.parse(localStorage.getItem('completedDays')||'[]');
      if(completed.includes(today)){ const btn=document.getElementById('checkBtn'); btn.textContent='오늘 학습 완료! 🎉'; btn.classList.add('completed'); btn.disabled=true; }
      const c=document.getElementById('sliderContainer');
      c.addEventListener('touchstart', handleTouchStart, {passive:true});
      c.addEventListener('touchmove', handleTouchMove, {passive:true});
      c.addEventListener('touchend', handleTouchEnd);
      c.addEventListener('mousedown', handleMouseDown);
      c.addEventListener('mousemove', handleMouseMove);
      c.addEventListener('mouseup', handleMouseUp);
      c.addEventListener('mouseleave', handleMouseUp);
      window.addEventListener('resize', updateSlidePosition);
    }
    init();
  </script>
</body>
</html>